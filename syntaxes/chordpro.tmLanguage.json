{
  "$schema": "https://raw.githubusercontent.com/martinring/tmlanguage/master/tmlanguage.json",
  "name": "ChordPro",
  "scopeName": "source.chordpro",
  "patterns": [
    { "include": "#comments" },
    { "include": "#directives" },
    { "include": "#chords" },
    { "include": "#lyrics" }
  ],
  "repository": {
    "comments": {
      "patterns": [
        {
          "name": "comment.line.number-sign.chordpro",
          "match": "^#.*$"
        }
      ]
    },
    "directives": {
      "patterns": [
        {
          "name": "meta.directive.title.chordpro",
          "match": "\\{(title|t)\\s*:\\s*([^}]*)\\}",
          "captures": {
            "1": { "name": "keyword.control.directive.chordpro" },
            "2": { "name": "string.unquoted.title.chordpro" }
          }
        },
        {
          "name": "meta.directive.subtitle.chordpro",
          "match": "\\{(subtitle|st|artist)\\s*:\\s*([^}]*)\\}",
          "captures": {
            "1": { "name": "keyword.control.directive.chordpro" },
            "2": { "name": "string.unquoted.subtitle.chordpro" }
          }
        },
        {
          "name": "meta.directive.comment.chordpro",
          "match": "\\{(comment|c|comment_italic|ci|comment_box|cb)\\s*:\\s*([^}]*)\\}",
          "captures": {
            "1": { "name": "keyword.control.directive.chordpro" },
            "2": { "name": "comment.block.chordpro" }
          }
        },
        {
          "name": "meta.directive.section.chordpro",
          "match": "\\{(start_of_chorus|soc|end_of_chorus|eoc|start_of_verse|sov|end_of_verse|eov|start_of_bridge|sob|end_of_bridge|eob|start_of_tab|sot|end_of_tab|eot|chorus)\\}",
          "captures": {
            "1": { "name": "keyword.control.section.chordpro" }
          }
        },
        {
          "name": "meta.directive.chord-definition.chordpro",
          "match": "\\{(define|chord)\\s*:\\s*([^}]*)\\}",
          "captures": {
            "1": { "name": "keyword.control.directive.chordpro" },
            "2": { "name": "entity.name.tag.chord-definition.chordpro" }
          }
        },
        {
          "name": "meta.directive.key.chordpro",
          "match": "\\{(key|capo|tempo|time)\\s*:\\s*([^}]*)\\}",
          "captures": {
            "1": { "name": "keyword.control.directive.chordpro" },
            "2": { "name": "constant.numeric.chordpro" }
          }
        },
        {
          "name": "meta.directive.formatting.chordpro",
          "match": "\\{(new_song|ns|new_page|np|new_physical_page|npp|column_break|colb)\\}",
          "captures": {
            "1": { "name": "keyword.control.formatting.chordpro" }
          }
        },
        {
          "name": "meta.directive.generic.chordpro",
          "match": "\\{([a-zA-Z_][a-zA-Z0-9_]*)\\s*(?::\\s*([^}]*))?\\}",
          "captures": {
            "1": { "name": "keyword.control.directive.chordpro" },
            "2": { "name": "string.unquoted.value.chordpro" }
          }
        }
      ]
    },
    "chords": {
      "patterns": [
        {
          "name": "entity.name.tag.chord.chordpro",
          "match": "\\[([A-Ga-g][#b]?(?:m|min|maj|dim|aug|sus[24]?|add[0-9]+|[0-9]+)?(?:\\/[A-Ga-g][#b]?)?)\\]",
          "captures": {
            "1": { "name": "constant.other.chord.chordpro" }
          }
        }
      ]
    },
    "lyrics": {
      "patterns": [
        {
          "name": "string.unquoted.lyrics.chordpro",
          "match": "(?<=\\])[^\\[\\{\\n]+|^[^\\[\\{#\\n][^\\[\\{\\n]*"
        }
      ]
    }
  }
}
